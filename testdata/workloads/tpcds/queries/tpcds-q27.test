====
---- QUERY: TPCDS-Q27
select
  i_item_id,
  s_state,
  -- grouping(s_state) g_state,
  avg(ss_quantity) agg1,
  avg(ss_list_price) agg2,
  avg(ss_coupon_amt) agg3,
  avg(ss_sales_price) agg4
from
  store_sales,
  customer_demographics,
  date_dim,
  store,
  item
where
  ss_sold_date_sk = d_date_sk
  and ss_item_sk = i_item_sk
  and ss_store_sk = s_store_sk
  and ss_cdemo_sk = cd_demo_sk
  and cd_gender = 'F'
  and cd_marital_status = 'W'
  and cd_education_status = 'Primary'
  and d_year = 1998
  and s_state in ('WI', 'CA', 'TX', 'FL', 'WA', 'TN')
  and ss_sold_date_sk between 2450815 and 2451179  -- partition key filter
group by
  -- rollup (i_item_id, s_state)
  i_item_id,
  s_state
order by
  i_item_id,
  s_state
limit 100;
---- RESULTS
'AAAAAAAAAAKBAAAA','TN',7,87.58,64.06,16.64
'AAAAAAAAAAPBAAAA','TN',6,87.26,NULL,NULL
'AAAAAAAAABEDAAAA','TN',76,132.50,377.60,99.37
'AAAAAAAAABGAAAAA','TN',58,16.67,0.00,6.00
'AAAAAAAAABLBAAAA','TN',99,87.60,854.96,50.80
'AAAAAAAAABOCAAAA','TN',99,55.69,0.00,49.00
'AAAAAAAAACJAAAAA','TN',5,86.28,0.00,50.04
'AAAAAAAAACJCAAAA','TN',56,104.37,0.00,55.31
'AAAAAAAAACLDAAAA','TN',93,6.70,0.00,3.35
'AAAAAAAAACPDAAAA','TN',96,88.68,292.67,7.09
'AAAAAAAAADDEAAAA','TN',26,45.17,0.00,28.00
'AAAAAAAAADHBAAAA','TN',51,97.68,0.00,51.77
'AAAAAAAAADKBAAAA','TN',15,92.10,0.00,6.44
'AAAAAAAAADNDAAAA','TN',71,105.42,0.00,34.78
'AAAAAAAAAEBDAAAA','TN',76,105.15,1924.19,29.44
'AAAAAAAAAEECAAAA','TN',83,106.43,0.00,71.30
'AAAAAAAAAEEDAAAA','TN',1,37.90,0.00,35.62
'AAAAAAAAAFDAAAAA','TN',66,53.14,1115.99,45.70
'AAAAAAAAAFGCAAAA','TN',3,88.53,0.00,83.21
'AAAAAAAAAFGDAAAA','TN',71,34.19,0.00,24.61
'AAAAAAAAAGBEAAAA','TN',78,139.86,523.53,33.56
'AAAAAAAAAHDEAAAA','TN',72,118.30,0.00,13.01
'AAAAAAAAAHIBAAAA','TN',70,168.16,0.00,122.75
'AAAAAAAAAIIBAAAA','TN',65.5,115.60,797.94,64.73
'AAAAAAAAAJBBAAAA','TN',86,28.53,0.00,22.25
'AAAAAAAAAJCCAAAA','TN',74,71.12,0.00,9.24
'AAAAAAAAAJHAAAAA','TN',2,135.97,0.00,114.21
'AAAAAAAAAJKAAAAA','TN',15,88.40,0.00,70.72
'AAAAAAAAAJLDAAAA','TN',38,182.13,0.00,74.67
'AAAAAAAAAKMDAAAA','TN',77,101.27,0.00,98.23
'AAAAAAAAALMAAAAA','TN',23,101.43,198.48,37.52
'AAAAAAAAAMABAAAA','TN',55,127.02,1466.85,38.10
'AAAAAAAAAMDBAAAA','TN',5,85.09,0.00,51.90
'AAAAAAAAAMDEAAAA','TN',29,33.22,0.00,27.57
'AAAAAAAAAMEAAAAA','TN',98,147.70,0.00,13.29
'AAAAAAAAAMICAAAA','TN',37,69.07,42.91,16.57
'AAAAAAAAAMLAAAAA','TN',63,101.63,0.00,40.65
'AAAAAAAAANABAAAA','TN',85,38.40,0.00,16.51
'AAAAAAAAANAEAAAA','TN',54,31.49,0.00,24.56
'AAAAAAAAANDDAAAA','TN',43,170.16,0.00,122.51
'AAAAAAAAAOEBAAAA','TN',94,78.58,0.00,42.43
'AAAAAAAAAOHBAAAA','TN',42,141.03,0.00,115.64
'AAAAAAAAAOKCAAAA','TN',71,39.16,810.50,31.71
'AAAAAAAAAPGBAAAA','TN',32,99.61,0.00,58.76
'AAAAAAAAAPIAAAAA','TN',70,124.69,2793.71,120.94
'AAAAAAAABAADAAAA','TN',40,26.11,0.00,3.65
'AAAAAAAABAFEAAAA','TN',76,51.74,0.00,19.66
'AAAAAAAABAJAAAAA','TN',3,134.06,85.26,71.05
'AAAAAAAABAKCAAAA','TN',71,60.70,1672.16,24.28
'AAAAAAAABAPDAAAA','TN',44,88.92,0.00,62.24
'AAAAAAAABBNBAAAA','TN',42,139.89,0.00,48.96
'AAAAAAAABCNAAAAA','TN',84,139.60,0.00,37.69
'AAAAAAAABDGDAAAA','TN',49,24.89,0.00,2.24
'AAAAAAAABDHCAAAA','TN',60,27.62,0.00,25.41
'AAAAAAAABFHDAAAA','TN',94,31.46,0.00,0.00
'AAAAAAAABIDBAAAA','TN',56,140.91,0.00,23.95
'AAAAAAAABIGBAAAA','TN',21,37.77,0.00,24.92
'AAAAAAAABJBCAAAA','TN',32,2.96,0.00,0.00
'AAAAAAAABJFEAAAA','TN',96,43.52,0.00,16.97
'AAAAAAAABKFDAAAA','TN',47,23.11,487.22,11.78
'AAAAAAAABLDEAAAA','TN',10,12.16,0.00,9.12
'AAAAAAAABMDAAAAA','TN',84,43.80,0.00,35.91
'AAAAAAAABNCAAAAA','TN',37,122.93,0.00,11.06
'AAAAAAAABNLDAAAA','TN',56,83.50,0.00,5.01
'AAAAAAAABOGBAAAA','TN',42,98.26,3031.98,91.38
'AAAAAAAABPGAAAAA','TN',40,59.76,0.00,15.53
'AAAAAAAACABEAAAA','TN',35,107.64,0.00,35.52
'AAAAAAAACACEAAAA','TN',21,10.20,0.00,6.73
'AAAAAAAACAEEAAAA','TN',11,54.23,0.00,11.38
'AAAAAAAACALBAAAA','TN',72,146.68,0.00,71.87
'AAAAAAAACAMCAAAA','TN',29,5.33,0.00,4.79
'AAAAAAAACAOBAAAA','TN',9,34.38,103.65,17.19
'AAAAAAAACBFCAAAA','TN',4,73.22,14.05,3.66
'AAAAAAAACBOCAAAA','TN',100,85.56,0.00,83.84
'AAAAAAAACCICAAAA','TN',17,89.34,0.00,64.32
'AAAAAAAACCMAAAAA','TN',42,30.54,0.00,8.10
'AAAAAAAACDIDAAAA','TN',59,20.70,161.61,12.38
'AAAAAAAACDLAAAAA','TN',58,71.89,0.00,19.41
'AAAAAAAACEABAAAA','TN',63,110.83,0.00,5.54
'AAAAAAAACEBEAAAA','TN',74,31.51,90.90,8.19
'AAAAAAAACEEAAAAA','TN',42,116.06,0.00,49.90
'AAAAAAAACFAEAAAA','TN',17,51.60,0.00,27.86
'AAAAAAAACFIBAAAA','TN',93,121.19,0.00,9.69
'AAAAAAAACGACAAAA','TN',11,137.04,0.00,98.66
'AAAAAAAACGMDAAAA','TN',53,76.98,0.00,73.90
'AAAAAAAACHBAAAAA','TN',79,112.14,0.00,108.77
'AAAAAAAACHICAAAA','TN',99,42.85,0.00,42.42
'AAAAAAAACHLAAAAA','TN',26,146.89,0.00,8.81
'AAAAAAAACHPCAAAA','TN',13,45.93,0.00,18.83
'AAAAAAAACIBDAAAA','TN',2,6.31,0.16,4.10
'AAAAAAAACJBEAAAA','TN',71,46.81,0.00,1.87
'AAAAAAAACJLDAAAA','TN',35,91.70,2199.19,70.60
'AAAAAAAACJODAAAA','TN',4,68.66,140.87,65.22
'AAAAAAAACKOAAAAA','TN',17,164.89,0.00,153.34
'AAAAAAAACLCEAAAA','TN',18,78.95,0.00,43.42
'AAAAAAAACLEAAAAA','TN',84,55.07,0.00,51.21
'AAAAAAAACLJDAAAA','TN',28,14.37,72.85,5.31
'AAAAAAAACMBEAAAA','TN',18,133.72,0.00,64.18
'AAAAAAAACMIBAAAA','TN',6,100.05,0.00,19.00
'AAAAAAAACMMAAAAA','TN',36,127.11,0.00,105.50
---- TYPES
STRING, STRING, DOUBLE, DECIMAL, DECIMAL, DECIMAL
====